<?phpnamespace Kaoshi\Controller;class IndexController extends MobileCommonController{    //方法：index    public function index()    {//        $a = ['A'=>'dayu','B'=>'xiaoyu'];//        $b = json_encode($a);//        var_dump($b);        //单选题        $num = M('ti')->where(array('type' => 1,'status' => 1))->count();        $all = M('ti')->where(array('type' => 1,'status' => 1))->select();        foreach ($all as $key =>$item){            $all[$key]['item'] =  json_decode($item['item'],true);        }//        var_dump($all);die;        $this->assign('ti', $all);        $this->assign('num', $num);        $this->assign('title', C('CFG_WEBNAME'));        //插入或不操作考试统计表        $data = [            'user_id'=>1,            'answer'=>'',            'all_num'=>0,            'yes_num'=>0,            'score'=>0,            'elapsed'=>0,            'status'=>0,            'create_time'=>date('Y-m-d H:i:s',time()),            ];        $kaoshi = M('ti_kaoshi')->where(array('user_id' => 1,'status' => 0))->order('create_time desc')->find();        if(empty($kaoshi)){            M('ti_kaoshi')->add($data);        }        $this->display();    }    public function saveUserAnswer()    {        $data = I('post.');        $kaoshi = M('ti_kaoshi')->where(array('user_id' => 1,'status' => 0))->order('create_time desc')->find();        if(empty($kaoshi)){            //异常捕获            //重复保存        }else{            //写入日志表            $data3 = [                'user_id'=>1,                'answer'=>json_encode($data['question']),                'score'=>$data['insertscore'],                'kaoshi_id'=>$kaoshi['id'],                'create_time'=>date('Y-m-d H:i:s',time()),            ];            $yes = M('ti_log')->add($data3);            //更新考试统计表            $data2 = [                'user_id'=>1,                'answer'=>json_encode($data['question']),                'all_num'=>count($data['question']),                'yes_num'=>$data['insertscore'],                'score'=>$data['insertscore'],                'elapsed'=>time(),                'status'=>1,                'end_time'=>date('Y-m-d H:i:s',time()),            ];            $yes2 = M('ti_kaoshi')->where(array('user_id' => 1,'status' => 0))->save($data2);        }        if($yes2){            $this->ajaxReturn(['status'=>1,'msg'=>'交卷成功'],JSON);        }else{            $this->ajaxReturn(['status'=>0,'msg'=>'交卷失败'],JSON);        }    }    public function result()    {        $this->assign('title', C('CFG_WEBNAME'));        $this->display();    }    public function exampaper()    {        $data = I('post.');        var_dump($data);    }    public function answer()    {        $this->assign('title', C('CFG_WEBNAME'));        $this->display();    }}